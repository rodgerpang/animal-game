<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Animal Rhythm Game</title>
  <style>
    body {
      font-family: sans-serif;
      text-align: center;
      padding: 20px;
    }

#game {
  display: grid;
  grid-template-columns: repeat(4, 100px);
  grid-gap: 10px;
  justify-content: center;
  margin-top: 20px;
}

.box {
  width: 100px;
  height: 100px;
  border: 2px solid #333;
  display: flex;
  align-items: center;
  justify-content: center;
  background-color: #eee;
  transition: all 0.2s;
  overflow: hidden;
  box-sizing: border-box;
}

.highlight {
  background-color: yellow;
  border: 4px solid orange;
  box-shadow: 0 0 20px gold;
}

#counter {
  margin-top: 20px;
  font-size: 64px;
  font-weight: bold;
  color: red;
}

button {
  padding: 10px 20px;
  font-size: 18px;
  cursor: pointer;
}

#level {
  margin-top: 10px;
  font-weight: bold;
}

img {
  max-width: 90%;
  max-height: 90%;
  transition: transform 0.2s;
}
  </style>
</head>
<body>
  <h1>Animal Rhythm Game</h1>
  <button id="startBtn">Start</button>
  <div id="level">Level 1</div>

  <div id="game">
    <div class="box" id="box0"></div>
    <div class="box" id="box1"></div>
    <div class="box" id="box2"></div>
    <div class="box" id="box3"></div>
    <div class="box" id="box4"></div>
    <div class="box" id="box5"></div>
    <div class="box" id="box6"></div>
    <div class="box" id="box7"></div>
  </div>
  <div id="counter"></div>

  <script>
    const startBtn = document.getElementById('startBtn');
    const boxes = Array.from(document.getElementsByClassName('box'));
    const levelDisplay = document.getElementById('level');
    const counterDisplay = document.getElementById('counter');

    let level = 1;
    const speed = 350; // adjust if you want dynamic speed later

    const animalsByLevel = [
        ['cat.jpg', 'dog.jpg'],           
        ['cat.jpg', 'dog.jpg', 'horse.jpg', 'cow.jpg'],  
        ['cat.jpg', 'dog.jpg', 'horse.jpg', 'cow.jpg', 'bird.jpg', 'rabbit.jpg'],  
        ['cat.jpg', 'dog.jpg', 'horse.jpg', 'cow.jpg', 'bird.jpg', 'rabbit.jpg', 'pig.jpg', 'mouse.jpg'],  
        ['cat.jpg', 'dog.jpg', 'horse.jpg', 'cow.jpg', 'bird.jpg', 'rabbit.jpg', 'pig.jpg', 'mouse.jpg', 'bear.jpg', 'chicken.jpg']
    ];

    function getAnimalPool(level) {
      if(level <= 2) return animalsByLevel[0];
      if(level <= 4) return animalsByLevel[1];
      if(level <= 6) return animalsByLevel[2];
      if(level <= 8) return animalsByLevel[3];
      return animalsByLevel[4];
    }

    function generateSequence(level){
      const pool = getAnimalPool(level);
      const sequence = [];
      for(let i=0; i<8; i++){
        const randAnimal = pool[Math.floor(Math.random() * pool.length)];
        sequence.push(randAnimal);
      }
      return sequence;
    }

    function displayAnimals(sequence){
      boxes.forEach((box, idx) => {
        const img = document.createElement('img');
        img.src = sequence[idx];
        box.innerHTML = '';
        box.appendChild(img);
      });
    }

    // Highlight beep
    function playBeep() {
      const beep = new Audio('beep.mp3'); 
      beep.play().catch(e => console.log('Beep blocked until user interacts:', e));
    }

    // Array of 8 count-in sounds
    const countSounds = [
      '1.m4a', '2.m4a', '3.m4a', '4.m4a',
      '5.m4a', '6.m4a', '7.m4a', '8.m4a'
    ];

    function playCountSound(index){
      if(index < 0 || index >= countSounds.length) return;
      const audio = new Audio(countSounds[index]);
      audio.play().catch(e => console.log('Count sound blocked until user interacts:', e));
    }

    function playBeepCountIn(callback){
      let count = 1;
      function step() {
        if(count <= 8){
          counterDisplay.textContent = count;
          playCountSound(count - 1); // play corresponding sound
          count++;
          setTimeout(step, speed);
        } else {
          counterDisplay.textContent = '';
          if(callback) callback();
        }
      }
      step();
    }

    function playSequence(sequence, callback){
      let i = 0;
      function highlightNext() {
        if(i > 0) boxes[i-1].classList.remove('highlight');
        if(i < sequence.length){
          boxes[i].classList.add('highlight');
          playBeep(); // beep for highlighting
          i++;
          setTimeout(highlightNext, speed);
        } else {
          boxes[sequence.length-1].classList.remove('highlight');
          if(callback) callback();
        }
      }
      highlightNext();
    }

    function startLevel() {
      levelDisplay.textContent = `Level ${level}`;
      const sequence = generateSequence(level);
      displayAnimals(sequence);

      playBeepCountIn(() => {
        playSequence(sequence, () => {
          level++;
          if(level > 50) level = 1; // loop back
          setTimeout(startLevel, 1);
        });
      });
    }

    startBtn.addEventListener('click', () => {
      startBtn.disabled = true;
      startLevel();
    });
  </script>
</body>
</html>
